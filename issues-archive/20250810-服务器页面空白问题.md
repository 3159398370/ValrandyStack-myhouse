# 服务器页面空白问题归档

## 📋 问题概述

**问题**：服务器端网站 `https://learningtree.fun` 显示页面空白，JS 文件 404 错误  
**发现时间**：2025 年 8 月 10 日 9:14:00
**影响**：生产环境前端页面无法正常显示  
**严重性**：⭐⭐⭐⭐⭐ (5 星 - 严重) - 网站完全无法访问，影响所有用户

## 🔍 根本原因

### 1. Vite 配置问题

`vite.config.js` 中的 `base` 配置不正确：

```javascript
// 错误配置
base: "./"; // 相对路径无法正确解析

// 正确配置
base: "/"; // 绝对路径
```

### 2. HTML 模板路径问题

```html
<!-- 错误 -->
<link rel="icon" href="./favicon.ico" />

<!-- 正确 -->
<link rel="icon" href="/favicon.ico" />
```

### 3. 服务器配置缺失

- 缺少 API 代理配置
- 缺少前端路由支持

## 🛠️ 解决方案

### 1. 前端配置修改

```javascript
// vite.config.js
export default defineConfig({
  base: "/", // 使用绝对路径
  // ... 其他配置
});
```

```html
<!-- index.html -->
<link rel="icon" href="/favicon.ico" />
```

```bash
# 重新构建
cd frontend
npm run build
```

### 2. 服务器配置添加

在宝塔 Nginx 配置中添加：

```nginx
# API 代理
location /api/ {
    proxy_pass http://127.0.0.1:8000;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
}

# 前端路由支持
location / {
    try_files $uri $uri/ /index.html;
}
```

### 3. 环境变量配置

```bash
# 后端 .env
DEBUG=False
SECRET_KEY=your-production-secret-key
ALLOWED_HOSTS=learningtree.fun,www.learningtree.fun

# 前端 .env.production
VITE_API_BASE_URL=https://learningtree.fun/api
```

## 📚 经验总结

### 关键教训

1. 前端构建工具的路径配置直接影响生产环境
2. 开发环境和生产环境的差异需要特别注意
3. 单页应用需要特殊的服务器配置支持

### 预防措施

1. 统一使用绝对路径配置
2. 部署前检查所有配置文件
3. 建立自动化测试流程验证部署结果

---

**归档日期**：2025 年 8 月 10 日 9:14:00
**归档人员**：Valrandy·Joseph
**问题状态**：已解决  
**解决时间**：约 2 小时
